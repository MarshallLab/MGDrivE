<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MGDrivE: Model's Mathematical Description — MGDrivE-Model • MGDrivE</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="MGDrivE: Model's Mathematical Description — MGDrivE-Model" />
<meta property="og:description" content="The original version of this model was based on work by (Deredec et al. 2011; Hancock and Godfray 2007)

and adapted to accommodate CRISPR homing dynamics in a previous publication by
our team (Marshall et al. 2017)
. As
it was described, we extended this framework to be able to handle a variable
number of genotypes, and migration across spatial scenarios. We did this by
adapting the equations to work in a tensor-oriented manner, where each genotype
can have different processes affecting their particular strain
(death rates, mating fitness, sex-ratio bias, et cetera)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MGDrivE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mgdrive_examples.html">Example Simulations</a>
    </li>
    <li>
      <a href="../articles/mgdrive_math.html">Mathematical Description</a>
    </li>
    <li>
      <a href="../articles/mgdrive_run.html">Detailed Run Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MarshallLab/MGDrivE">
    <span class="fa fa-lg fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MGDrivE: Model's Mathematical Description</h1>
    
    <div class="hidden name"><code>MGDrivE-Model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The original version of this model was based on work by (Deredec et al. 2011; Hancock and Godfray 2007)

and adapted to accommodate CRISPR homing dynamics in a previous publication by
our team (Marshall et al. 2017)
. As
it was described, we extended this framework to be able to handle a variable
number of genotypes, and migration across spatial scenarios. We did this by
adapting the equations to work in a tensor-oriented manner, where each genotype
can have different processes affecting their particular strain
(death rates, mating fitness, sex-ratio bias, et cetera).</p>
    </div>



    <h2 class="hasAnchor" id="inheritance-cube-and-oviposition"><a class="anchor" href="#inheritance-cube-and-oviposition"></a>Inheritance Cube and Oviposition</h2>

    


<p>To allow the extension of the framework to an arbitrary number of genotypes,
we transformed traditional inheritance matrices into inheritance cubes, where
each of the axis represents the following information:</p><ul>
<li><p>x: female adult mate genotype</p></li>
<li><p>y: male adult mate genotype</p></li>
<li><p>z: proportion of the offspring that inherits a given genotype (slice)</p></li>
</ul>

<p>The 'cube' structure gives us the flexibility to apply tensor operations to
the elements within our equations, so that we can calculate the stratified
population dynamics rapidly; and within a readable, flexible computational
framework. This becomes apparent when we define the equation we use for the
computation of eggs laid at any given point in time:
$$\overline{O(T_x)} = \sum_{j=1}^{n} \Bigg( \bigg( (\beta*\overline{s} * \overline{ \overline{Af_{[t-T_x]}}}) * \overline{\overline{\overline{Ih}}} \bigg) * \Lambda  \Bigg)^{\top}_{ij}$$
In this equation, the matrix containing the number of mated adult females
(\(\overline{\overline{Af}}\)) is multiplied element-wise with each one of
the slices containing the eggs genotypes proportions expected from this cross
(\(\overline{\overline{\overline{Ih}}}\)). The resulting matrix is then
multiplied by a binary 'viability mask' (\(\Lambda\)) that filters out
female-parent to offspring genetic combinations that are not viable due to
biological impediments (such as cytoplasmic incompatibility). The summation
of the transposed resulting matrix returns us the total fraction of eggs
resulting from all the male to female genotype crosses (\(\overline{O(T_{x})}\)).</p>
<p>Note: For inheritance operations to be consistent within the framework, the
summation of each element in the 'z' axis (this is, the proportions of each
one of the offspring's genotypes) must be equal to one.</p>
    <h2 class="hasAnchor" id="population-dynamics"><a class="anchor" href="#population-dynamics"></a>Population Dynamics</h2>

    


<p>During the three aquatic stages, a density-independent mortality process takes place:
$$\theta_{st}=(1-\mu_{st})^{T_{st}}$$
Along with a density dependent process dependent on the number of larvae in the environment:
$$F(L[t])=\Bigg(\frac{\alpha}{\alpha+\sum{\overline{L[t]}}}\Bigg)^{1/T_l}$$
where \(\alpha\) represents the strength of the density-dependent process.
This parameter  is calculated with:
$$\alpha=\Bigg( \frac{1/2 * \beta * \theta_e * Ad_{eq}}{R_m-1} \Bigg) * \Bigg( \frac{1-(\theta_l / R_m)}{1-(\theta_l / R_m)^{1/T_l}} \Bigg)$$
in which \(\beta\) is the species' fertility in the absence of gene-drives,
\(Ad_{eq}\) is the adult mosquito population equilibrium size, and \(R_{m}\)
is the population growth in the absence of density-dependent mortality. This
population growth is calculated with the average generation time (\(g\)),
the adult mortality rate (\(\mu_{ad}\)), and the daily population growth rate (\(r_{m}\)):
$$	g=T_{e}+T_{l}+T_{p}+\frac{1}{\mu_{ad}}\\R_{m}=(r_{m})^{g}$$</p>
<h3>Larval Stages</h3>
<p>The computation of the larval stage in the population is crucial to the model
because the density dependent processes necessary for equilibrium trajectories
to be calculated occur here. This calculation is performed with the following equation:
$$
D(\theta_l,T_x) = \left
        \begin{array}{ll}
            \theta_{l[0]}^{'}=\theta_l 								&amp; \quad i = 0 \\
            \theta_{l[i+1]}^{'} = \theta_{l[i]}^{'} *F(\overline{L_{[t-i-T_x]}})	&amp; \quad i \leq T_l
        \end{array}
    \right.
$$
In addition to this, we need the larval mortality (\(\mu_{l}\)):
$$
	%L_{eq}=&amp;\alpha*\lfloor R_{m} -1\rfloor
	%&amp;
	\mu_{l}=1-\Bigg( \frac{R_{m} * \mu_{ad}}{1/2 * \beta * (1-\mu_{m})} \Bigg)^{\frac{1}{T_{e}+T_{l}+T_{p}}}
$$
With these mortality processes, we are now able to calculate the larval population:
$$
	\overline{L_{[t]}}=
		\overline{L_{[t-1]}} * (1-\mu_{l}) * F(\overline{L_{[t-1]})}\\
		+\overline{O(T_{e})}* \theta_{e} \\
		%+\overline{\beta}* \theta_{e} * (\overline{\overline{Af_{(t-T_{e})}}} \circ \overline{\overline{\overline{Ih}}})\\
		- \overline{O(T_{e}+T_{l})} * \theta_{e} * D(\theta_{l},0)
		%\prod_{i=1}^{T_{l}} F(\overline{L_{[t-i]}})
		%\theta_{l}
$$
where the first term accounts for larvae surviving one day to the other; the
second term accounts for the eggs that have hatched within the same period of
time; and the last term computes the number of larvae that have transformed into pupae.</p>

<h3>Adult Stages</h3>
<p>We are ultimately interested in calculating how many adults of each genotype
exist at any given point in time. For this, we first calculate the number of
eggs that are laid and survive to the adult stages with the equation:
$$
	\overline{E^{'}}= \overline{O(T_{e}+T_{l}+T_{p})} \\
	* \bigg(\overline{\xi_{m}} * (\theta_{e} * \theta_{p}) * (1-\mu_{ad}) * D(\theta_{l},T_{p}) \bigg)
$$
With this information we can calculate the current number of male adults in
the population by computing the following equation:
$$
	\overline{Am_{[t]}}=
		\overline{Am_{[t-1]}} * (1-\mu_{ad})*\overline{\omega_{m}}\\
		+ (1-\overline{\phi}) *  \overline{E^{'}}\\
 		+ \overline{\nu m_{[t-1]}}
$$
in which the first term represents the number of males surviving from one day
to the next; the second one, the fraction of males that survive to adulthood
(\(\overline{E'}\)) and emerge as males (\(1-\phi\)); the last one is used
to add males into the population as part of gene-drive release campaigns.</p>
<p>Female adult populations are calculated in a similar way:
$$
 \overline{\overline{Af_{[t]}}}=
   \overline{\overline{Af_{[t-1]}}} * (1-\mu_{ad}) * \overline{\omega_{f}}\\
   +  \bigg( \overline{\phi} * \overline{E^{'}}+\overline{\nu f_{[t-1]}}\bigg)^{\top} * \bigg( \frac{\overline{\overline{\eta}}*\overline{Am_{[t-1]}}}{\sum{\overline{Am_{[t-1]}}}} \bigg)%\overline{\overline{Mf}}
$$
where we first compute the surviving female adults from one day to the next;
and then we calculate the mating composition of the female fraction emerging
from pupa stage. To do this, we obtain the surviving fraction of eggs that
survive to adulthood (\(\overline{E'}\)) and emerge as females (\(\phi\)),
we then add the new females added as a result of gene-drive releases (\(\overline{\nu f_{[t-1]}}\)).
After doing this, we calculate the proportion of males that are allocated to
each female genotype, taking into account their respective mating fitnesses
(\(\overline{\overline{\eta}}\)) so that we can introduce the new adult
females into the population pool.</p>

    <h2 class="hasAnchor" id="gene-drive-releases-and-effects"><a class="anchor" href="#gene-drive-releases-and-effects"></a>Gene Drive Releases and Effects</h2>

    


<p>As it was briefly mentioned before, we are including the option to release
both male and/or female individuals into the populations. Another important t
hing to emphasize is that we allow flexible releases sizes and schedules. Our ]
model handles releases internally as lists of populations compositions so, it
is possible to have releases performed at irregular intervals and with different
numbers of mosquito genetic compositions as long as no new genotypes are
introduced (which have not been previously defined in the inheritance cube).
$$
 \overline{\nu} = \bigg\{
   \left(\begin{array}{c} g_1 \\ g_2 \\ g_3 \\ \vdots \\ g_n \end{array}\right)_{t=1} ,
   \left(\begin{array}{c} g_1 \\ g_2 \\ g_3 \\ \vdots \\ g_n \end{array}\right)_{t=2} ,
   \cdots ,
   \left(\begin{array}{c} g_1 \\ g_2 \\ g_3 \\ \vdots \\ g_n \end{array}\right)_{t=x}
\bigg\}
$$
So far, however, we have not described the way in which the effects of these
gene-drives are included into the mosquito populations dynamics. This is done
through the use of various modifiers included in the equations:</p><ul>
<li><p>\(\overline{\omega}\): Relative increase in mortality (zero being full mortality effects and one no mortality effect)</p></li>
<li><p>\(\overline{\phi}\): Relative shift in the sex of the pupating mosquitoes (zero biases the sex ratio towards males, whilst 1 biases the ratio towards females).</p></li>
<li><p>\(\overline{\overline{\eta}}\): Standardized mating fitness (zero being complete fitness ineptitude, and one being regular mating skills).</p></li>
<li><p>\(\overline{\beta}\): Fecundity (average number of eggs laid).</p></li>
<li><p>\(\overline{\xi}\): Pupation success (zero being full mortality and one full pupation success).</p></li>
</ul>

    <h2 class="hasAnchor" id="migration"><a class="anchor" href="#migration"></a>Migration</h2>

    


<p>To simulate migration within our framework we are considering patches (or nodes)
of fully-mixed populations in a network structure. This allows us to handle
mosquito movement across spatially-distributed populations with a transitions
matrix, which is calculated with the tensor outer product of the genotypes
populations tensors and the transitions matrix of the network as follows:
$$
   \overline{Am_{(t)}^{i}}=
   	\sum{\overline{A_{m}^j} \otimes \overline{\overline{\tau m_{[t-1]}}}} \\
     	\overline{\overline{Af_{(t)}^{i}}}=
     \sum{\overline{\overline{A_{f}^j}} \otimes \overline{\overline{\tau f_{[t-1]}}}}
$$
In these equations the new population of the patch \(i\) is calculated by
summing the migrating mosquitoes of all the \(j\) patches across the network
defined by the transitions matrix \(\tau\), which stores the mosquito migration
probabilities from patch to patch.mIt is worth noting that the migration
probabilities matrices can be different for males and females; and that there's
no inherent need for them to be static (the migration probabilities may vary
over time to accommodate wind changes due to seasonality).</p>
    <h2 class="hasAnchor" id="parameters"><a class="anchor" href="#parameters"></a>Parameters</h2>

    


<p>This table compiles all the parameters required to run MGDrivE clustered in six categories:</p><ul>
<li><p>Life Stages: These deal with the structure of mosquito population.</p></li>
<li><p>Bionomics: This set of parameters is related to the behavior of the specific mosquito species being modeled.</p></li>
<li><p>Gene Drive: Genotype-specific vectors of parameters that affect how each gene-drive modifies the responses of populations to them.</p></li>
<li><p>Releases:  List of vectors that control the release of genetically-modified mosquitoes.</p></li>
<li><p>Population:  General mosquito-population parameters that control environmentally-determined variables.</p></li>
<li><p>Network: Related to migration between nodes of population units</p></li>
</ul>

    <h2 class="hasAnchor" id="stochasticity"><a class="anchor" href="#stochasticity"></a>Stochasticity</h2>

    

<p><em>MGDrivE</em> allows stochasticity to be included in the dynamics of various
processes; in an effort to simulate processes that affect various stages of
mosquitoes lives. In the next section, we will describe all the stochastic
processes that can be activated in the program. It should be noted that all
of these can be turned on and off independently from one another as required
by the researcher.</p>
<h3>Mosquito Biology</h3>
<p><strong>Oviposition</strong></p>
<p>Stochastic egg laying by female/male pairs is separated into two steps:
calculating the number of eggs laid by the females and then distributing laid
eggs according to their genotypes. The number of eggs laid follows a Poisson
distribution conditioned on the number of female/male pairs and the fertility
of each female.
$$Poisson( \lambda = numFemales*Fertility)$$
Multinomial sampling, conditioned on the number of offspring and the relative
viability of each genotype, determines the genotypes of the offspring.
$$Multinomial \left(numOffspring, p_1, p_2\dots p_b \right)=\frac{numOffspring!}{p_1!\,p_2\,\dots p_n}p_1^{n_1}p_2^{n_2}\dots p_n^{n_n}$$</p>
<p><strong>Sex Determination</strong></p>
<p>Sex of the offspring is determined by multinomial sampling. This is conditioned
on the number of eggs that live to hatching and a probability of being female,
allowing the user to design systems that skew the sex ratio of the offspring
through reproductive mechanisms.
$$Multinomial(numHatchingEggs, p_{female}, p_{female})$$</p>
<p><strong>Mating</strong>
Stochastic mating is determined by multinomial sampling conditioned on the
number of males and their fitness. It is assumed that females mate only once
in their life, therefore each female will sample from the available males and
be done, while the males are free to potentially mate with multiple females.
The males' ability to mate is modulated with a fitness term, thereby allowing
some genotypes to be less fit than others (as seen often with lab releases).
$$Multinomial(numFemales, p_1f_1, p_2f_2, \dots p_nf_n)$$</p>
<p><strong>Hatching</strong></p>
<p><strong>Other Stochastic Processes</strong>
All remaining stochastic processes (larval survival, hatching , pupating,
surviving to adult hood) are determined by multinomial sampling conditioned
on factors affecting the current life stage. These factors are determined
empirically from mosquito population data.</p>

<h3>Migration</h3>
<p>Variance of stochastic movement (not used in diffusion model of migration).
It affects the concentration of probability in the Dirchlet simplex, small
values lead to high variance and large values lead to low variance.</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Deredec A, Godfray HCJ, Burt A (2011).
&#8220;Requirements for effective malaria control with homing endonuclease genes.&#8221;
<em>Proceedings of the National Academy of Sciences of the United States of America</em>, <b>108</b>(43), E874--80.
ISSN 1091-6490, doi: <a href='https://doi.org/10.1073/pnas.1110717108'>10.1073/pnas.1110717108</a>
, <a href='https://www.pnas.org/content/108/43/E874'>https://www.pnas.org/content/108/43/E874</a>.<br /><br /> Hancock PA, Godfray HCJ (2007).
&#8220;Application of the lumped age-class technique to studying the dynamics of malaria-mosquito-human interactions.&#8221;
<em>Malaria journal</em>, <b>6</b>, 98.
ISSN 1475-2875, doi: <a href='https://doi.org/10.1186/1475-2875-6-98'>10.1186/1475-2875-6-98</a>
, <a href='https://malariajournal.biomedcentral.com/articles/10.1186/1475-2875-6-98'>https://malariajournal.biomedcentral.com/articles/10.1186/1475-2875-6-98</a>.<br /><br /> Marshall J, Buchman A, C. HMS, Akbari OS (2017).
&#8220;Overcoming evolved resistance to population-suppressing homing-based gene drives.&#8221;
<em>Nature Scientific Reports</em>, 1--46.
ISSN 2045-2322, doi: <a href='https://doi.org/10.1038/s41598-017-02744-7'>10.1038/s41598-017-02744-7</a>
, <a href='https://www.nature.com/articles/s41598-017-02744-7'>https://www.nature.com/articles/s41598-017-02744-7</a>.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#inheritance-cube-and-oviposition">Inheritance Cube and Oviposition</a></li>
      <li><a href="#population-dynamics">Population Dynamics</a></li>
      <li><a href="#gene-drive-releases-and-effects">Gene Drive Releases and Effects</a></li>
      <li><a href="#migration">Migration</a></li>
      <li><a href="#parameters">Parameters</a></li>
      <li><a href="#stochasticity">Stochasticity</a></li>
      <li><a href="#references">References</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://chipdelmal.github.io'>Héctor Manuel Sánchez Castellanos</a>, <a href='https://github.com/GilChrist19'>Jared Bennett</a>, <a href='https://slwu89.github.io'>Sean Wu</a>, <a href='https://www.marshalllab.com'>John M. Marshall</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


