<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MGDrivE Run Example • MGDrivE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MGDrivE Run Example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MGDrivE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mgdrive_examples.html">Example Simulations</a>
    </li>
    <li>
      <a href="../articles/mgdrive_math.html">Mathematical Description</a>
    </li>
    <li>
      <a href="../articles/mgdrive_run.html">Detailed Run Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MarshallLab/MGDrivE">
    <span class="fa fa-lg fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>MGDrivE Run Example</h1>
            
      
      
      <div class="hidden name"><code>mgdrive_run.Rmd</code></div>

    </div>

    
    
<style type="text/css">
pre {
  white-space: pre !important;
  overflow-y: scroll !important;
  max-height: 25vh !important;
}

# reference
#  https://stackoverflow.com/questions/41135085/how-to-make-vertical-scrollbar-appear-in-rmarkdown-code-chunks-html-view
</style>
<div id="mgdrive-one-run" class="section level2">
<h2 class="hasAnchor">
<a href="#mgdrive-one-run" class="anchor"></a>MGDrivE, One Run</h2>
<p>The other <a href="mgdrive_examples.html">vignette</a> has many examples of calculating movement matrices, different simulations, and some theory for comparison. However, it does not go through each step of setting up, running, and analyzing a simulation. This vignette is designed to go through every step of a simulation, exploring why each step is performed, some thoughts on how they can be modified, and looking at the output (if any).</p>
<div id="mendelian-inheritance-stochastic-multiple-populations" class="section level3">
<h3 class="hasAnchor">
<a href="#mendelian-inheritance-stochastic-multiple-populations" class="anchor"></a>Mendelian Inheritance, Stochastic, Multiple Populations</h3>
<p>For our example, we will take the Stochastic, Small Migration example from the other vignette as a starting point. We will expand it to 5 populations, so that that code is a bit longer and the file structure becomes more obvious.</p>
<div id="full-code" class="section level4">
<h4 class="hasAnchor">
<a href="#full-code" class="anchor"></a>Full Code</h4>
<p>For reference, here is the full code for our example. It will be explained piece-by-piece below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># Load libraries</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MGDrivE)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># Output Folder</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">outFolder &lt;-<span class="st"> "mgdrive"</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(<span class="dt">path =</span> outFolder)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># Simulation Parameters</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># days to run the simulation</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">tMax &lt;-<span class="st"> </span><span class="dv">365</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co"># number of Monte Carlo iterations</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">nRep &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co"># each Monte Carlo iteration gets its own folder</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">folderNames &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(outFolder,</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">                        <span class="kw"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span>nRep, <span class="dt">width =</span> <span class="dv">3</span>, <span class="dt">format =</span> <span class="st">"d"</span>, <span class="dt">flag =</span> <span class="st">"0"</span>))</a>
<a class="sourceLine" id="cb1-24" data-line-number="24"></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co"># entomological parameters</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">bioParameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">betaK=</span><span class="dv">20</span>,<span class="dt">tEgg=</span><span class="dv">5</span>,<span class="dt">tLarva=</span><span class="dv">6</span>,<span class="dt">tPupa=</span><span class="dv">4</span>,<span class="dt">popGrowth=</span><span class="fl">1.175</span>,<span class="dt">muAd=</span><span class="fl">0.09</span>)</a>
<a class="sourceLine" id="cb1-27" data-line-number="27"></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co"># a 5-node network with 5% per day migration rate</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29">sitesNumber &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30">adultPopEquilibrium &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co"># auxiliary function</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33">triDiag &lt;-<span class="st"> </span><span class="cf">function</span>(upper, lower){</a>
<a class="sourceLine" id="cb1-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb1-35" data-line-number="35">  <span class="co"># return matrix</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36">  retMat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">data =</span> <span class="dv">0</span>, <span class="dt">nrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(upper) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(upper) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-37" data-line-number="37">  </a>
<a class="sourceLine" id="cb1-38" data-line-number="38">  <span class="co"># set index values for upper/lower triangles</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39">  indx &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(upper)</a>
<a class="sourceLine" id="cb1-40" data-line-number="40">  </a>
<a class="sourceLine" id="cb1-41" data-line-number="41">  <span class="co"># set forward/backward migration using matrix access</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42">  retMat[<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(indx<span class="op">+</span><span class="dv">1</span>,indx)] &lt;-<span class="st"> </span>lower</a>
<a class="sourceLine" id="cb1-43" data-line-number="43">  retMat[<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(indx,indx<span class="op">+</span><span class="dv">1</span>)] &lt;-<span class="st"> </span>upper</a>
<a class="sourceLine" id="cb1-44" data-line-number="44">  </a>
<a class="sourceLine" id="cb1-45" data-line-number="45">  <span class="co"># set stay probs</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46">  <span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="dt">x =</span> retMat) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="dt">x =</span> retMat)</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">  </a>
<a class="sourceLine" id="cb1-48" data-line-number="48">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(retMat)</a>
<a class="sourceLine" id="cb1-49" data-line-number="49">}</a>
<a class="sourceLine" id="cb1-50" data-line-number="50"></a>
<a class="sourceLine" id="cb1-51" data-line-number="51"><span class="co"># fill movement matrix</span></a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="co">#  Remember, rows need to sum to 1.</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53">moveMat &lt;-<span class="st"> </span><span class="kw">triDiag</span>(<span class="dt">upper =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="dt">x =</span> <span class="fl">0.05</span>, <span class="dt">times =</span> sitesNumber<span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-54" data-line-number="54">                   <span class="dt">lower =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="dt">x =</span> <span class="fl">0.05</span>, <span class="dt">times =</span> sitesNumber<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb1-55" data-line-number="55"></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="co"># batch migration is disabled by setting the probability to 0</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57">batchMigration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/basicBatchMigration.html">basicBatchMigration</a></span>(<span class="dt">batchProbs=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1-58" data-line-number="58">                                     <span class="dt">sexProbs=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">5</span>,.<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb1-59" data-line-number="59">                                     <span class="dt">numPatches=</span>sitesNumber)</a>
<a class="sourceLine" id="cb1-60" data-line-number="60"></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-62" data-line-number="62"><span class="co"># Basic Inheritance pattern</span></a>
<a class="sourceLine" id="cb1-63" data-line-number="63"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-64" data-line-number="64"><span class="co"># Mendelian cube with standard (default) paraameters</span></a>
<a class="sourceLine" id="cb1-65" data-line-number="65">cube &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cubeMendelian.html">cubeMendelian</a></span>()</a>
<a class="sourceLine" id="cb1-66" data-line-number="66"></a>
<a class="sourceLine" id="cb1-67" data-line-number="67"></a>
<a class="sourceLine" id="cb1-68" data-line-number="68"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-69" data-line-number="69"><span class="co"># Setup releases and batch migration</span></a>
<a class="sourceLine" id="cb1-70" data-line-number="70"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-71" data-line-number="71"><span class="co"># set up the empty release vector</span></a>
<a class="sourceLine" id="cb1-72" data-line-number="72"><span class="co">#  MGDrivE pulls things out by name</span></a>
<a class="sourceLine" id="cb1-73" data-line-number="73">patchReleases &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="dt">n=</span>sitesNumber,</a>
<a class="sourceLine" id="cb1-74" data-line-number="74">                           <span class="dt">expr=</span>{<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">maleReleases=</span><span class="ot">NULL</span>,<span class="dt">femaleReleases=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1-75" data-line-number="75">                                      <span class="dt">eggReleases=</span><span class="ot">NULL</span>,<span class="dt">matedFemaleReleases=</span><span class="ot">NULL</span>)},</a>
<a class="sourceLine" id="cb1-76" data-line-number="76">                           <span class="dt">simplify=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-77" data-line-number="77"></a>
<a class="sourceLine" id="cb1-78" data-line-number="78"><span class="co"># choose release parameters</span></a>
<a class="sourceLine" id="cb1-79" data-line-number="79"><span class="co">#  Releases start at time 25, occur once a week, for 10 weeks.</span></a>
<a class="sourceLine" id="cb1-80" data-line-number="80"><span class="co">#  There are 100 mosquitoes released every time.</span></a>
<a class="sourceLine" id="cb1-81" data-line-number="81">releasesParameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">releasesStart=</span><span class="dv">25</span>,</a>
<a class="sourceLine" id="cb1-82" data-line-number="82">                          <span class="dt">releasesNumber=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1-83" data-line-number="83">                          <span class="dt">releasesInterval=</span><span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1-84" data-line-number="84">                          <span class="dt">releaseProportion=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-85" data-line-number="85"></a>
<a class="sourceLine" id="cb1-86" data-line-number="86"><span class="co"># generate male release vector</span></a>
<a class="sourceLine" id="cb1-87" data-line-number="87">maleReleasesVector &lt;-<span class="st"> </span><span class="kw"><a href="../reference/generateReleaseVector.html">generateReleaseVector</a></span>(<span class="dt">driveCube=</span>cube, </a>
<a class="sourceLine" id="cb1-88" data-line-number="88">                                           <span class="dt">releasesParameters=</span>releasesParameters)</a>
<a class="sourceLine" id="cb1-89" data-line-number="89"></a>
<a class="sourceLine" id="cb1-90" data-line-number="90"><span class="co"># generate female release vector</span></a>
<a class="sourceLine" id="cb1-91" data-line-number="91">femaleReleasesVector &lt;-<span class="st"> </span><span class="kw"><a href="../reference/generateReleaseVector.html">generateReleaseVector</a></span>(<span class="dt">driveCube=</span>cube,</a>
<a class="sourceLine" id="cb1-92" data-line-number="92">                                             <span class="dt">releasesParameters=</span>releasesParameters)</a>
<a class="sourceLine" id="cb1-93" data-line-number="93"></a>
<a class="sourceLine" id="cb1-94" data-line-number="94"><span class="co"># put releases into the proper place in the release list</span></a>
<a class="sourceLine" id="cb1-95" data-line-number="95"><span class="co">#  This performs the releases in the first patch only</span></a>
<a class="sourceLine" id="cb1-96" data-line-number="96">patchReleases[[<span class="dv">1</span>]]<span class="op">$</span>maleReleases &lt;-<span class="st"> </span>maleReleasesVector</a>
<a class="sourceLine" id="cb1-97" data-line-number="97">patchReleases[[<span class="dv">1</span>]]<span class="op">$</span>femaleReleases &lt;-<span class="st"> </span>femaleReleasesVector</a>
<a class="sourceLine" id="cb1-98" data-line-number="98"></a>
<a class="sourceLine" id="cb1-99" data-line-number="99"></a>
<a class="sourceLine" id="cb1-100" data-line-number="100"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-101" data-line-number="101"><span class="co"># Combine parameters and run!</span></a>
<a class="sourceLine" id="cb1-102" data-line-number="102"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-103" data-line-number="103"><span class="co"># setup parameters for the network. This builds a list of parameters required for</span></a>
<a class="sourceLine" id="cb1-104" data-line-number="104"><span class="co">#  every population in the network.</span></a>
<a class="sourceLine" id="cb1-105" data-line-number="105">netPar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/parameterizeMGDrivE.html">parameterizeMGDrivE</a></span>(<span class="dt">runID=</span><span class="dv">1</span>, <span class="dt">simTime=</span>tMax, <span class="dt">nPatch=</span>sitesNumber,</a>
<a class="sourceLine" id="cb1-106" data-line-number="106">                             <span class="dt">beta=</span>bioParameters<span class="op">$</span>betaK, <span class="dt">muAd=</span>bioParameters<span class="op">$</span>muAd,</a>
<a class="sourceLine" id="cb1-107" data-line-number="107">                             <span class="dt">popGrowth=</span>bioParameters<span class="op">$</span>popGrowth, <span class="dt">tEgg=</span>bioParameters<span class="op">$</span>tEgg,</a>
<a class="sourceLine" id="cb1-108" data-line-number="108">                             <span class="dt">tLarva=</span>bioParameters<span class="op">$</span>tLarva, <span class="dt">tPupa=</span>bioParameters<span class="op">$</span>tPupa,</a>
<a class="sourceLine" id="cb1-109" data-line-number="109">                             <span class="dt">AdPopEQ=</span>adultPopEquilibrium, <span class="dt">inheritanceCube =</span> cube)</a>
<a class="sourceLine" id="cb1-110" data-line-number="110"></a>
<a class="sourceLine" id="cb1-111" data-line-number="111"><span class="co"># set MGDrivE to run stochastic</span></a>
<a class="sourceLine" id="cb1-112" data-line-number="112"><span class="kw"><a href="../reference/setupMGDrivE.html">setupMGDrivE</a></span>(<span class="dt">stochasticityON =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-113" data-line-number="113"></a>
<a class="sourceLine" id="cb1-114" data-line-number="114"><span class="co"># build network prior to run</span></a>
<a class="sourceLine" id="cb1-115" data-line-number="115">MGDrivESim &lt;-<span class="st"> </span>Network<span class="op">$</span><span class="kw">new</span>(<span class="dt">params=</span>netPar,</a>
<a class="sourceLine" id="cb1-116" data-line-number="116">                         <span class="dt">driveCube=</span>cube,</a>
<a class="sourceLine" id="cb1-117" data-line-number="117">                         <span class="dt">patchReleases=</span>patchReleases,</a>
<a class="sourceLine" id="cb1-118" data-line-number="118">                         <span class="dt">migrationMale=</span>moveMat,</a>
<a class="sourceLine" id="cb1-119" data-line-number="119">                         <span class="dt">migrationFemale=</span>moveMat,</a>
<a class="sourceLine" id="cb1-120" data-line-number="120">                         <span class="dt">migrationBatch=</span>batchMigration,</a>
<a class="sourceLine" id="cb1-121" data-line-number="121">                         <span class="dt">directory=</span>folderNames,</a>
<a class="sourceLine" id="cb1-122" data-line-number="122">                         <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-123" data-line-number="123"><span class="co"># run simulation</span></a>
<a class="sourceLine" id="cb1-124" data-line-number="124">MGDrivESim<span class="op">$</span><span class="kw">multRun</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-125" data-line-number="125"></a>
<a class="sourceLine" id="cb1-126" data-line-number="126"></a>
<a class="sourceLine" id="cb1-127" data-line-number="127"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-128" data-line-number="128"><span class="co"># Post Analysis</span></a>
<a class="sourceLine" id="cb1-129" data-line-number="129"><span class="co">####################</span></a>
<a class="sourceLine" id="cb1-130" data-line-number="130"><span class="co"># First, split output by patch</span></a>
<a class="sourceLine" id="cb1-131" data-line-number="131"><span class="co"># Second, aggregate females by their mate choice</span></a>
<a class="sourceLine" id="cb1-132" data-line-number="132"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nRep){</a>
<a class="sourceLine" id="cb1-133" data-line-number="133"> <span class="kw"><a href="../reference/splitOutput.html">splitOutput</a></span>(<span class="dt">readDir =</span> folderNames[i], <span class="dt">remFile =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-134" data-line-number="134"> <span class="kw"><a href="../reference/aggregateFemales.html">aggregateFemales</a></span>(<span class="dt">readDir =</span> folderNames[i], <span class="dt">genotypes =</span> cube<span class="op">$</span>genotypesID,</a>
<a class="sourceLine" id="cb1-135" data-line-number="135">                  <span class="dt">remFile =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-136" data-line-number="136">}</a>
<a class="sourceLine" id="cb1-137" data-line-number="137"></a>
<a class="sourceLine" id="cb1-138" data-line-number="138"><span class="co"># plot output of first run to see effect</span></a>
<a class="sourceLine" id="cb1-139" data-line-number="139"><span class="kw"><a href="../reference/plotMGDrivESingle.html">plotMGDrivESingle</a></span>(<span class="dt">readDir=</span>folderNames[<span class="dv">1</span>],<span class="dt">totalPop =</span> <span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="fl">3.5</span>,<span class="dt">alpha=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-140" data-line-number="140"></a>
<a class="sourceLine" id="cb1-141" data-line-number="141"><span class="co"># plot all 5 repetitions together</span></a>
<a class="sourceLine" id="cb1-142" data-line-number="142"><span class="kw"><a href="../reference/plotMGDrivEMult.html">plotMGDrivEMult</a></span>(<span class="dt">readDir=</span>outFolder,<span class="dt">lwd=</span><span class="fl">0.35</span>,<span class="dt">alpha=</span><span class="fl">0.75</span>)</a></code></pre></div>
</div>
<div id="load-libraries" class="section level4">
<h4 class="hasAnchor">
<a href="#load-libraries" class="anchor"></a>Load Libraries</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">####################</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># Load libraries</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">####################</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MGDrivE)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; Loading MGDrivE: Mosquito Gene Drive Explorer</span></a></code></pre></div>
<p>Step one, load <em>MGDrivE</em>.</p>
</div>
<div id="setup-folder-directory" class="section level4">
<h4 class="hasAnchor">
<a href="#setup-folder-directory" class="anchor"></a>Setup Folder Directory</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">####################</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># Output Folder</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">####################</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">outFolder &lt;-<span class="st"> "mgdrive"</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(<span class="dt">path =</span> outFolder)</a></code></pre></div>
<p>Here, we setup the folder for simulation data. Since this is a local folder, it doesn’t exist, and needs to be created. If you already have a folder prepared, make sure it is empty. <em>MGDrivE</em> gives a warning if there are other things in the folder (to prevent overwriting of data), but will run fine if the folder is not empty.</p>
</div>
<div id="simulation-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#simulation-parameters" class="anchor"></a>Simulation Parameters</h4>
<p>Next, there are several parameters that need to be set for a simulation. The run time and the number of repetitions are crucial. Once the number of repetitions has been chosen, the folder names can be created.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">####################</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># Simulation Parameters</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">####################</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># days to run the simulation</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">tMax &lt;-<span class="st"> </span><span class="dv">365</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># number of Monte Carlo iterations</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">nRep &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co"># each Monte Carlo iteration gets its own folder</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">folderNames &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(outFolder,</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">                        <span class="kw"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span>nRep, <span class="dt">width =</span> <span class="dv">3</span>, <span class="dt">format =</span> <span class="st">"d"</span>, <span class="dt">flag =</span> <span class="st">"0"</span>))</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">folderNames</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; [1] "mgdrive/001" "mgdrive/002" "mgdrive/003" "mgdrive/004" "mgdrive/005"</span></a></code></pre></div>
<p>Here, folder names reflect their purpose - holding each repetition of our stochastic simulation. The precise names don’t matter later on, but they do need to be unique (or data gets overwritten, <em>MGDrivE</em> will not throw a warning about this), and in a location that your user account has permission to create directories.</p>
<p>The biological parameters were chosen for <em>Aedes aegypti</em> in our original simulations. These parameters represent:</p>
<ul>
<li>
<code>betaK</code>: Daily number of eggs laid per female mosquito</li>
<li>
<code>tEgg</code>: Number of days spent in the egg stage</li>
<li>
<code>tLarva</code>: Number of days spent in the larval stage</li>
<li>
<code>tPupa</code>: Number of days spent in the pupa stage</li>
<li>
<code>popGrowth</code>: Population growth per generation<br>
</li>
<li>
<code>muAD</code>: Daily death rate for adult mosquitoes</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># entomological parameters</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">bioParameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">betaK=</span><span class="dv">20</span>,<span class="dt">tEgg=</span><span class="dv">5</span>,<span class="dt">tLarva=</span><span class="dv">6</span>,<span class="dt">tPupa=</span><span class="dv">4</span>,<span class="dt">popGrowth=</span><span class="fl">1.175</span>,<span class="dt">muAd=</span><span class="fl">0.09</span>)</a></code></pre></div>
<p>Next, we set the number of populations in the simulation. Here, we chose 5 populations, each containing 500 mosquitoes. After that, we setup the landscape.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># a 5-node network with 5% per day migration rate</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">sitesNumber &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">adultPopEquilibrium &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">patchPops &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(adultPopEquilibrium,sitesNumber) </a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># patchPops is optional. If all populations are the same size, parameterizeMGDrivE</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#  can take a single number. However, if you desire different population sizes, it </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#  must be a vector of length equal to the number of sites</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co"># landscape</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># auxiliary function</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">triDiag &lt;-<span class="st"> </span><span class="cf">function</span>(upper, lower){</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  <span class="co"># return matrix</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  retMat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">data =</span> <span class="dv">0</span>, <span class="dt">nrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(upper) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(upper) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  <span class="co"># set index values for upper/lower triangles</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  indx &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(upper)</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb6-19" data-line-number="19">  <span class="co"># set forward/backward migration using matrix access</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20">  retMat[<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(indx<span class="op">+</span><span class="dv">1</span>,indx)] &lt;-<span class="st"> </span>lower</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">  retMat[<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(indx,indx<span class="op">+</span><span class="dv">1</span>)] &lt;-<span class="st"> </span>upper</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb6-23" data-line-number="23">  <span class="co"># set stay probs</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24">  <span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="dt">x =</span> retMat) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="dt">x =</span> retMat)</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">  </a>
<a class="sourceLine" id="cb6-26" data-line-number="26">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(retMat)</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">}</a>
<a class="sourceLine" id="cb6-28" data-line-number="28"></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co"># fill movement matrix</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#  Remember, rows need to sum to 1.</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31">moveMat &lt;-<span class="st"> </span><span class="kw">triDiag</span>(<span class="dt">upper =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="dt">x =</span> <span class="fl">0.05</span>, <span class="dt">times =</span> sitesNumber<span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb6-32" data-line-number="32">                   <span class="dt">lower =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span>(<span class="dt">x =</span> <span class="fl">0.05</span>, <span class="dt">times =</span> sitesNumber<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb6-33" data-line-number="33"></a>
<a class="sourceLine" id="cb6-34" data-line-number="34">moveMat</a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; [1,] 0.95 0.05 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; [2,] 0.05 0.90 0.05 0.00 0.00</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; [3,] 0.00 0.05 0.90 0.05 0.00</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; [4,] 0.00 0.00 0.05 0.90 0.05</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; [5,] 0.00 0.00 0.00 0.05 0.95</span></a></code></pre></div>
<p>Our landscape will be a line, with each population only connected to the populations on either side. We set a 5% per day migration rate. There are several examples in the other <a href="mgdrive_examples.html">vignette</a> for setting up different landscapes.</p>
<p>Finally, there is the possibility of large-group movement facilitated by humans (using <em>Aedes</em> for example, this could be boats or water containers in truck beds, etc.). <em>MGDrivE</em> handles this through <code><a href="../reference/basicBatchMigration.html">basicBatchMigration()</a></code>. For simplicity, we are ignoring this possibility (by setting the probability of it to zero).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># batch migration is disabled by setting the probability to 0</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">batchMigration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/basicBatchMigration.html">basicBatchMigration</a></span>(<span class="dt">batchProbs=</span><span class="dv">0</span>, <span class="dt">numPatches=</span>sitesNumber)</a></code></pre></div>
</div>
<div id="inheritance-pattern" class="section level4">
<h4 class="hasAnchor">
<a href="#inheritance-pattern" class="anchor"></a>Inheritance Pattern</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">####################</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co"># Basic Inheritance pattern</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">####################</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># Mendelian cube with standard (default) paraameters</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">cube &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cubeMendelian.html">cubeMendelian</a></span>()</a></code></pre></div>
<p>For this experiment, we use simple Mendelian inheritance. <em>MGDrivE</em> has several other inheritance patterns, which include:</p>
<ul>
<li>
<code><a href="../reference/cubeReciprocalTranslocations.html">cubeReciprocalTranslocations()</a></code>: Reciprocal Translocations<br>
</li>
<li>
<code><a href="../reference/cubeHomingDrive.html">cubeHomingDrive()</a></code>: CRISPR-based homing drive, with two resistance alleles<br>
</li>
<li>
<code><a href="../reference/cubeMEDEA.html">cubeMEDEA()</a></code>: Maternal Effect Dominant Embryonic Arrest</li>
</ul>
<p>While we use the default parameters, there are several fitness costs that can be applied. Every cost is applied in a genotype-specific manner. The optional fitness costs are:</p>
<ul>
<li>
<span class="math inline">\(\eta\)</span>: Male mating fitness against each female<br>
</li>
<li>
<span class="math inline">\(\phi\)</span>: Sex-ratio at emergence<br>
</li>
<li>
<span class="math inline">\(\omega\)</span>: Multiplicative modifier of adult mortality (males and females)<br>
</li>
<li>
<span class="math inline">\(\xi_F\)</span>: Female pupatory success (applies after <span class="math inline">\(\phi\)</span>)<br>
</li>
<li>
<span class="math inline">\(\xi_M\)</span>: Male pupatory success (applies after <span class="math inline">\(\phi\)</span>)<br>
</li>
<li>
<span class="math inline">\(s\)</span>: Fractional increase/decrease in fertility</li>
</ul>
</div>
<div id="releases" class="section level4">
<h4 class="hasAnchor">
<a href="#releases" class="anchor"></a>Releases</h4>
<p><em>MGDrivE</em> uses a list specifying releases of males or females to parameterize the release schedule. The initial list is <code>NULL</code>, and only if there are releases to be performed is anything added.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">####################</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># Setup releases and batch migration</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">####################</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co"># set up the empty release vector</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#  MGDrivE pulls things out by name</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">patchReleases &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="dt">n=</span>sitesNumber,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                           <span class="dt">expr=</span>{<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">maleReleases=</span><span class="ot">NULL</span>,<span class="dt">femaleReleases=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">                                      <span class="dt">eggReleases=</span><span class="ot">NULL</span>,<span class="dt">matedFemaleReleases=</span><span class="ot">NULL</span>)},</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">                           <span class="dt">simplify=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co"># choose release parameters</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#  Releases start at time 25, occur once a week, for 10 weeks.</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#  There are 100 mosquitoes released every time.</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">releasesParameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">releasesStart=</span><span class="dv">25</span>,</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">                          <span class="dt">releasesNumber=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">                          <span class="dt">releasesInterval=</span><span class="dv">7</span>,</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">                          <span class="dt">releaseProportion=</span><span class="dv">100</span>)</a></code></pre></div>
<p>Here, we are performing 10 releases of 100 individuals. These releases start on day 25 and occur every 7 days. We now generate what this looks like for a male release.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># generate male release vector</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">maleReleasesVector &lt;-<span class="st"> </span><span class="kw"><a href="../reference/generateReleaseVector.html">generateReleaseVector</a></span>(<span class="dt">driveCube=</span>cube, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                                           <span class="dt">releasesParameters=</span>releasesParameters)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">maleReleasesVector[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; $nRelease</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; [1,]    3  100</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; $tRelease</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; [1] 25</span></a></code></pre></div>
<p>The release vector generated is 10 elements long, because we have 10 releases, and each element contains the number and numeric genotype of individuals to release and the time of that release. We now generate the same thing for female releases, and insert the releases into our release list so that releases are only performed in the first patch.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># generate female release vector</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">femaleReleasesVector &lt;-<span class="st"> </span><span class="kw"><a href="../reference/generateReleaseVector.html">generateReleaseVector</a></span>(<span class="dt">driveCube=</span>cube,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                                             <span class="dt">releasesParameters=</span>releasesParameters)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co"># put releases into the proper place in the release list</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">patchReleases[[<span class="dv">1</span>]]<span class="op">$</span>maleReleases &lt;-<span class="st"> </span>maleReleasesVector</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">patchReleases[[<span class="dv">1</span>]]<span class="op">$</span>femaleReleases &lt;-<span class="st"> </span>femaleReleasesVector</a></code></pre></div>
</div>
<div id="setup-and-run" class="section level4">
<h4 class="hasAnchor">
<a href="#setup-and-run" class="anchor"></a>Setup and Run</h4>
<p>The final steps before running our simulation! All of the parameters we have setup are combined using <code><a href="../reference/parameterizeMGDrivE.html">parameterizeMGDrivE()</a></code>. Additionally, this function calculates equilibrium values for aquatic populations, death rates, and density dependence for every population. See the documentation for all of the possible options.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">####################</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># Combine parameters and run!</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">####################</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># setup parameters for the network. This builds a list of parameters required for</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#  every population in the network.</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">netPar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/parameterizeMGDrivE.html">parameterizeMGDrivE</a></span>(<span class="dt">runID=</span><span class="dv">1</span>, <span class="dt">simTime=</span>tMax, <span class="dt">nPatch=</span>sitesNumber,</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">                             <span class="dt">beta=</span>bioParameters<span class="op">$</span>betaK, <span class="dt">muAd=</span>bioParameters<span class="op">$</span>muAd,</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">                             <span class="dt">popGrowth=</span>bioParameters<span class="op">$</span>popGrowth, <span class="dt">tEgg=</span>bioParameters<span class="op">$</span>tEgg,</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">                             <span class="dt">tLarva=</span>bioParameters<span class="op">$</span>tLarva, <span class="dt">tPupa=</span>bioParameters<span class="op">$</span>tPupa,</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">                             <span class="dt">AdPopEQ=</span>patchPops, <span class="dt">inheritanceCube =</span> cube)</a></code></pre></div>
<p><em>MGDrivE</em> can run in either a deterministic or stochastic setting, so we set it to stochastic for these simulations.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># set MGDrivE to run stochastic</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="../reference/setupMGDrivE.html">setupMGDrivE</a></span>(<span class="dt">stochasticityON =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; initializing MGDrivE</span></a></code></pre></div>
<p>Finally, we setup the complete network to run our simulation.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># build network prior to run</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">MGDrivESim &lt;-<span class="st"> </span>Network<span class="op">$</span><span class="kw">new</span>(<span class="dt">params=</span>netPar,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                         <span class="dt">driveCube=</span>cube,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                         <span class="dt">patchReleases=</span>patchReleases,</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                         <span class="dt">migrationMale=</span>moveMat,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                         <span class="dt">migrationFemale=</span>moveMat,</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">                         <span class="dt">migrationBatch=</span>batchMigration,</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">                         <span class="dt">directory=</span>folderNames,</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">                         <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; initializing patch:  1  of  5 </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; initializing patch:  2  of  5 </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; initializing patch:  3  of  5 </span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; initializing patch:  4  of  5 </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; initializing patch:  5  of  5</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co"># list folders to show that they have been created</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder)</a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; [1] "001" "002" "003" "004" "005"</span></a></code></pre></div>
<p>The <code>Network</code> object represents the metapopulation of <em>MGDrivE</em>. It can be setup to hold 1 patch, and therefore be a single population, or several patches, and be a true metapopulation. Documentation can be found by running <code><a href="../reference/Network.html">?Network</a></code>. The different notation is an attribute of the <code>R6</code> structure that <em>MGDrivE</em> is built on (Shoutout to <a href="https://github.com/r-lib/R6">R6</a>). The <code>params</code> argument takes the network parameters created by <code><a href="../reference/parameterizeMGDrivE.html">parameterizeMGDrivE()</a></code>. The inheritance pattern is supplied in the <code>driveCube</code> option, which we chose to be Mendelian. Migration can be different for males and females, so even though here we use the same migration matrix, users can supply different ones if desired. The <code>migrationBatch</code> option must always be filled in, but can be set to zero, as done here, if it isn’t desired or for deterministic simulations (where it doesn’t make sense). Finally, the <code>directory</code> parameter takes the vector of folder names, and creates them for use during the simulation.</p>
<p>Finally, <em>MGDrivE</em> can be run once using <code>MGDrivESim$oneRun()</code> or several times using <code>MGDrivESim$multRun()</code>. The benefit of using the built-in multiple repetition function is that memory is not released between runs, just cleared, so setup-time is reduced. Additionally, each of these functions can produce a progress bar, which is suppressed in all of our vignettes.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># run simulation</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">MGDrivESim<span class="op">$</span><span class="kw">multRun</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="post-processing" class="section level4">
<h4 class="hasAnchor">
<a href="#post-processing" class="anchor"></a>Post Processing</h4>
<p><em>MGDrivE</em> outputs 2 *.csv files every simulation. These are stored as <code>{F|M}_RunXXX.csv</code> for female and male adults. In them are the population counts for every genotype at every day.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># first and last repetitions</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt; [1] "001"</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span>], <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; [1] "F_Run001.csv" "M_Run001.csv"</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder)[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; [1] "005"</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)[<span class="dv">5</span>], <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt; [1] "F_Run005.csv" "M_Run005.csv"</span></a></code></pre></div>
<p>This is the raw output from <em>MGDrivE</em>. The files contain all of the information from the simulation.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># read in male and female files</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">mMat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">                                             <span class="dt">recursive =</span> <span class="ot">TRUE</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">                           <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">","</span>))</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">fMat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                                             <span class="dt">recursive =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">                           <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">","</span>))</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co"># look at male file header</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(mMat)</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt; [1] "Time"  "Patch" "AA"    "Aa"    "aa"</span></a></code></pre></div>
<p>The header for male files (<code>M_RunXXX.csv</code>) is shown above. They always contains the time, patch, and every possible genotype in the simulation. For the Mendelian inheritance here, there are three possible genotypes, AA, Aa, aa. The Time and Patch columns will always be the same, but the number of genotypes changes depending on the inheritance pattern used. For example, CRISPR-based homing inheritance has 10, so there would be 12 columns in the male files. Below, we see how each patch is designated in the file.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">x =</span> mMat, <span class="dt">n =</span> <span class="dv">2</span><span class="op">*</span>sitesNumber)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt;       Time Patch  AA Aa aa</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt;  [1,]    0     1 250  0  0</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt;  [2,]    0     2 250  0  0</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt;  [3,]    0     3 250  0  0</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt;  [4,]    0     4 250  0  0</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt;  [5,]    0     5 250  0  0</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt;  [6,]    2     1 242  0  0</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt;  [7,]    2     2 242  0  0</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt;  [8,]    2     3 268  0  0</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt;  [9,]    2     4 255  0  0</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; [10,]    2     5 248  0  0</span></a></code></pre></div>
<p>Notice how each patch is printed for every time point, then the time increases and every patch is printed again. Time = 1 is at equilibrium, where we start the simulations, then the patches begin to diverge, staying around equilibrium but no longer being exactly the same.</p>
<p>The female output files (<code>F_RunXXX.csv</code>) are slightly more complicated. Since <em>MGDrivE</em> keeps track of females and their mates, the output maintains that as well. Thus, the header in the female files will be <span class="math inline">\(2 + \text{numGenotypes}^2\)</span> long. For Mendelian inheritance, this looks like:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># look at female file header</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(fMat)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt;  [1] "Time"  "Patch" "AAAA"  "AAAa"  "AAaa"  "AaAA"  "AaAa"  "Aaaa"  "aaAA" </span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; [10] "aaAa"  "aaaa"</span></a></code></pre></div>
<p>The Time and Patch columns are the same as in male files, but the “genotypes” are now a combination of the female genotype and her mate’s genotype. The length of the header is 11, consistent with having 3 genotypes, times the number of mate genotypes, plus the Time and Patch columns. The header “genotypes” are printed female genotype first, male (mate) second. So, the <em>aaAA</em> column represents females that are <em>aa</em> mated to males that are <em>AA</em>.<br>
The Time/Patch pattern is the same as in the male files.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">x =</span> fMat, <span class="dt">n =</span> <span class="dv">2</span><span class="op">*</span>sitesNumber)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt;       Time Patch AAAA AAAa AAaa AaAA AaAa Aaaa aaAA aaAa aaaa</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt;  [1,]    0     1  250    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt;  [2,]    0     2  250    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt;  [3,]    0     3  250    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt;  [4,]    0     4  250    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt;  [5,]    0     5  250    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt;  [6,]    2     1  243    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt;  [7,]    2     2  246    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt;  [8,]    2     3  245    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt;  [9,]    2     4  252    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; [10,]    2     5  250    0    0    0    0    0    0    0    0</span></a></code></pre></div>
<p>There are several things that we can do from here. We can work with the raw output directly, but this gets difficult as the simulations get larger. Therefor, we have provided functions to split the raw output by patches, generating a new file for every patch.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># First, split output by patch</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nRep){</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"> <span class="kw"><a href="../reference/splitOutput.html">splitOutput</a></span>(<span class="dt">readDir =</span> folderNames[i], <span class="dt">remFile =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">}</a></code></pre></div>
<p><code>splitOutput</code> splits the raw output by patch, generating one *.csv for every patch in our simulation. We loop over each repetition folder, removing the original files, and replacing them with individual patch files. Inside each repetition folder, we now see the files:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># first and last repetitions</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt; [1] "001"</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span>], <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt;  [1] "F_Run001_Patch001.csv" "F_Run001_Patch002.csv" "F_Run001_Patch003.csv"</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt;  [4] "F_Run001_Patch004.csv" "F_Run001_Patch005.csv" "M_Run001_Patch001.csv"</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt;  [7] "M_Run001_Patch002.csv" "M_Run001_Patch003.csv" "M_Run001_Patch004.csv"</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; [10] "M_Run001_Patch005.csv"</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder)[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; [1] "005"</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)[<span class="dv">5</span>], <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="co">#&gt;  [1] "F_Run005_Patch001.csv" "F_Run005_Patch002.csv" "F_Run005_Patch003.csv"</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="co">#&gt;  [4] "F_Run005_Patch004.csv" "F_Run005_Patch005.csv" "M_Run005_Patch001.csv"</span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="co">#&gt;  [7] "M_Run005_Patch002.csv" "M_Run005_Patch003.csv" "M_Run005_Patch004.csv"</span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="co">#&gt; [10] "M_Run005_Patch005.csv"</span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="co"># read in examples of new male/female files</span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18">twoFiles &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb22-19" data-line-number="19">                       <span class="dt">recursive =</span> <span class="ot">TRUE</span>)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">6</span>)]</a>
<a class="sourceLine" id="cb22-20" data-line-number="20"></a>
<a class="sourceLine" id="cb22-21" data-line-number="21"><span class="co"># read in male and female files</span></a>
<a class="sourceLine" id="cb22-22" data-line-number="22">mMat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="dt">file =</span> twoFiles[<span class="dv">2</span>], <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">","</span>))</a>
<a class="sourceLine" id="cb22-23" data-line-number="23">fMat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="dt">file =</span> twoFiles[<span class="dv">1</span>], <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">","</span>))</a></code></pre></div>
<p>We again look at a male file, examining the header and the first few rows.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">x =</span> mMat, <span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt;      Time  AA Aa aa</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; [1,]    0 250  0  0</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; [2,]    2 242  0  0</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; [3,]    3 232  0  0</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; [4,]    4 238  0  0</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; [5,]    5 250  0  0</span></a></code></pre></div>
<p>The Patch column has been removed, it is now part of the file name, and the Time column increases every row. This is the first repetition, first male file.</p>
<p>Female files are still a little more complicated. They have been split by patch, but still retain the mate information.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">x =</span> fMat, <span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt;      Time AAAA AAAa AAaa AaAA AaAa Aaaa aaAA aaAa aaaa</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt; [1,]    0  250    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; [2,]    2  243    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt; [3,]    3  244    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt; [4,]    4  248    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#&gt; [5,]    5  248    0    0    0    0    0    0    0    0</span></a></code></pre></div>
<p>The Patch column is gone, the Time column counts as expected, and we still have all of the mate information.</p>
<p>In the event that we don’t want/need the mate information, we can remove it using the <code><a href="../reference/aggregateFemales.html">aggregateFemales()</a></code> function.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># Second, aggregate females by their mate choice</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nRep){</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"> <span class="kw"><a href="../reference/aggregateFemales.html">aggregateFemales</a></span>(<span class="dt">readDir =</span> folderNames[i], <span class="dt">genotypes =</span> cube<span class="op">$</span>genotypesID,</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">                  <span class="dt">remFile =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">}</a></code></pre></div>
<p>This collects all of the females for each genotype, summing over the possible mates.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># changed female files in first repetition</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">#&gt; [1] "001"</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span>], <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="co">#&gt;  [1] "F_Aggregate_Run001_Patch001.csv" "F_Aggregate_Run001_Patch002.csv"</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="co">#&gt;  [3] "F_Aggregate_Run001_Patch003.csv" "F_Aggregate_Run001_Patch004.csv"</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">#&gt;  [5] "F_Aggregate_Run001_Patch005.csv" "M_Run001_Patch001.csv"          </span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">#&gt;  [7] "M_Run001_Patch002.csv"           "M_Run001_Patch003.csv"          </span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="co">#&gt;  [9] "M_Run001_Patch004.csv"           "M_Run001_Patch005.csv"</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="co"># read in examples of new female file</span></a>
<a class="sourceLine" id="cb26-12" data-line-number="12">fMat2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="dt">path =</span> outFolder,</a>
<a class="sourceLine" id="cb26-13" data-line-number="13">                                              <span class="dt">recursive =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb26-14" data-line-number="14">                                              <span class="dt">full.names =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb26-15" data-line-number="15">                            <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">","</span>))</a></code></pre></div>
<p>We see that all of the female files have been updated to denote that they are aggregated over their mate genotypes. Internally, the files now resemble the male files.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">x =</span> fMat2, <span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="co">#&gt;      Time  AA Aa aa</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">#&gt; [1,]    0 250  0  0</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">#&gt; [2,]    2 243  0  0</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">#&gt; [3,]    3 244  0  0</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">#&gt; [4,]    4 248  0  0</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="co">#&gt; [5,]    5 248  0  0</span></a></code></pre></div>
<p>This doesn’t show much change, but if we compare the female file split by patch to the aggregated female file at the time of the release, we can see that the genotypes have been combined.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># show non-aggregated female file split by patch</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">#  This is for patch number 1</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3">fMat[(releasesParameters<span class="op">$</span>releasesStart<span class="dv">-2</span>)<span class="op">:</span>(releasesParameters<span class="op">$</span>releasesStart<span class="op">+</span><span class="dv">2</span>), ]</a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">#&gt;      Time AAAA AAAa AAaa AaAA AaAa Aaaa aaAA aaAa aaaa</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">#&gt; [1,]   23  229    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="co">#&gt; [2,]   24  227    0    0    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="co">#&gt; [3,]   25  224    0    8    0    0    0   66    0   27</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="co">#&gt; [4,]   26  214    0   16    0    0    0   56    0   23</span></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co">#&gt; [5,]   27  211    0   14    0    0    0   52    0   23</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb28-11" data-line-number="11"></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co"># show aggregated female file</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="co">#  This is for patch number 1</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14">fMat2[(releasesParameters<span class="op">$</span>releasesStart<span class="dv">-2</span>)<span class="op">:</span>(releasesParameters<span class="op">$</span>releasesStart<span class="op">+</span><span class="dv">2</span>), ]</a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="co">#&gt;      Time  AA Aa aa</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="co">#&gt; [1,]   23 229  0  0</span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="co">#&gt; [2,]   24 227  0  0</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18"><span class="co">#&gt; [3,]   25 232  0 93</span></a>
<a class="sourceLine" id="cb28-19" data-line-number="19"><span class="co">#&gt; [4,]   26 230  0 79</span></a>
<a class="sourceLine" id="cb28-20" data-line-number="20"><span class="co">#&gt; [5,]   27 225  0 75</span></a></code></pre></div>
<p>Looking closely, we see the “AAAA” column combined with the “AAaa” column in the first output sum to the value in the “AA” column in the second.<br>
The same goes for the “aaAA” and “aaaa” columns in the first and the “aa” column in the second.</p>
</div>
<div id="plotting" class="section level4">
<h4 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h4>
<p><em>MGDrivE</em> comes with two built-in plot functions, <code><a href="../reference/plotMGDrivESingle.html">plotMGDrivESingle()</a></code> and <code><a href="../reference/plotMGDrivEMult.html">plotMGDrivEMult()</a></code>.<br><code><a href="../reference/plotMGDrivESingle.html">plotMGDrivESingle()</a></code> takes the name of one repetition folder, and plots all of the patches in it for both males and females.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># plot the first repetition</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw"><a href="../reference/plotMGDrivESingle.html">plotMGDrivESingle</a></span>(<span class="dt">readDir=</span>folderNames[<span class="dv">1</span>],<span class="dt">totalPop =</span> <span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="fl">3.5</span>,<span class="dt">alpha=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="mgdrive_run_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
<p>The left Y-axis is population size, the right Y-axis is patch number, and the X-axis is time. We can see the releases in the first patch, equal for males and females, and follow their migration down the plots from patch 1 to patch 5. The total population remains around 250 individuals for males and females, which gives the expected equilibrium value of 500.<br>
We can also plot all of our repetitions using <code><a href="../reference/plotMGDrivEMult.html">plotMGDrivEMult()</a></code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># plot all 5 repetitions together</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw"><a href="../reference/plotMGDrivEMult.html">plotMGDrivEMult</a></span>(<span class="dt">readDir=</span>outFolder,<span class="dt">lwd=</span><span class="fl">0.35</span>,<span class="dt">alpha=</span><span class="fl">0.75</span>)</a></code></pre></div>
<p><img src="mgdrive_run_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
<p><code><a href="../reference/plotMGDrivEMult.html">plotMGDrivEMult()</a></code> takes the name of the main directory, and finds all of the repetitions inside of it. It then plots males and females by patch, the same as <code><a href="../reference/plotMGDrivESingle.html">plotMGDrivESingle()</a></code>, but overlays a trace of every repetition for each patch.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#mgdrive-one-run">MGDrivE, One Run</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://chipdelmal.github.io">Héctor Manuel Sánchez Castellanos</a>, <a href="https://github.com/GilChrist19">Jared Bennett</a>, <a href="https://slwu89.github.io">Sean Wu</a>, <a href="https://www.marshalllab.com">John M. Marshall</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
