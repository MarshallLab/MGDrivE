<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate Trajectory From a SPN Model — sim_trajectory_R • MGDrivE2</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate Trajectory From a SPN Model — sim_trajectory_R" />
<meta property="og:description" content="This function provides a unified interface to the various simulation algorithms
for SPN, returning output sampled at a lattice of time points to the user, and
handling various exogenous events that may occur during the simulation
(such as release of adult mosquitoes)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MGDrivE2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/advanced_topics.html">MGDrivE2: Advanced Topics</a>
    </li>
    <li>
      <a href="../articles/epi-SEIR.html">MGDrivE2: SEIR Epidemiological Dynamics</a>
    </li>
    <li>
      <a href="../articles/epi-network.html">MGDrivE2: Metapopulation Network Epidemiological Dynamics</a>
    </li>
    <li>
      <a href="../articles/epi-node.html">MGDrivE2: One Node Epidemiological Dynamics</a>
    </li>
    <li>
      <a href="../articles/inhomogeneous.html">MGDrivE2: Simulation of Time-inhomogeneous Stochastic Processes (Seasonality)</a>
    </li>
    <li>
      <a href="../articles/lifecycle-network.html">MGDrivE2: Metapopulation Network Lifecycle Dynamics</a>
    </li>
    <li>
      <a href="../articles/lifecycle-node.html">MGDrivE2: One Node Lifecycle Dynamics</a>
    </li>
    <li>
      <a href="../articles/output-storage.html">MGDrivE2: Data Storage and Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MarshallLab/MGDrivE/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate Trajectory From a SPN Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/MarshallLab/MGDrivE/blob/master/R/sampling-trajectory-R.R'><code>R/sampling-trajectory-R.R</code></a></small>
    <div class="hidden name"><code>sim_trajectory_R.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function provides a unified interface to the various simulation algorithms
for SPN, returning output sampled at a lattice of time points to the user, and
handling various exogenous events that may occur during the simulation
(such as release of adult mosquitoes).</p>
    </div>

    <pre class="usage"><span class='fu'>sim_trajectory_R</span><span class='op'>(</span>
  <span class='va'>x0</span>,
  <span class='va'>tmax</span>,
  dt <span class='op'>=</span> <span class='fl'>1</span>,
  dt_stoch <span class='op'>=</span> <span class='fl'>0.1</span>,
  num_reps <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>S</span>,
  <span class='va'>hazards</span>,
  Sout <span class='op'>=</span> <span class='cn'>NULL</span>,
  sampler <span class='op'>=</span> <span class='st'>"tau"</span>,
  method <span class='op'>=</span> <span class='st'>"lsoda"</span>,
  events <span class='op'>=</span> <span class='cn'>NULL</span>,
  batch <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x0</th>
      <td><p>the initial marking of the SPN (initial state, M0)</p></td>
    </tr>
    <tr>
      <th>tmax</th>
      <td><p>the final time to end simulation (all simulations start at 0)</p></td>
    </tr>
    <tr>
      <th>dt</th>
      <td><p>the time-step at which to return output (<strong>not</strong> the time-step of the sampling algorithm)</p></td>
    </tr>
    <tr>
      <th>dt_stoch</th>
      <td><p>time-step used for approximation of hazards</p></td>
    </tr>
    <tr>
      <th>num_reps</th>
      <td><p>number of repetitions to run, default is 1.</p></td>
    </tr>
    <tr>
      <th>S</th>
      <td><p>a stoichiometry <code><a href='https://rdrr.io/pkg/Matrix/man/Matrix-class.html'>Matrix-class</a></code> object</p></td>
    </tr>
    <tr>
      <th>hazards</th>
      <td><p>list of hazard functions</p></td>
    </tr>
    <tr>
      <th>Sout</th>
      <td><p>an optional matrix to track event firings</p></td>
    </tr>
    <tr>
      <th>sampler</th>
      <td><p>determines sampling algorithm, one of; "ode", "tau", "cle", or "dm"</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>if <code>sampler</code> is "ode", the solver to use, from <code>deSolve</code></p></td>
    </tr>
    <tr>
      <th>events</th>
      <td><p>a <code>data.frame</code> of events, may be set to <code>NULL</code> if not used</p></td>
    </tr>
    <tr>
      <th>batch</th>
      <td><p>a <code>list</code> of batch migration events, created from <code><a href='batch_migration.html'>batch_migration</a></code>, may be set to <code>NULL</code> if not used</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>print a progress bar?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further named arguments passed to the step function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with 2 elements: "state" is the array of returned state values, and "events" will
return events tracked with <code>Sout</code> if provided, otherwise is <code>NULL</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>dt_stoch</code> is used by the Poisson Time-Step (<code><a href='step_PTS.html'>step_PTS</a></code>) and
Chemical Langevin (<code><a href='step_CLE.html'>step_CLE</a></code>) methods to approximate the hazards.
A smaller <code>dt_stoch</code> provides a better approximation, but will take longer
to run.</p>
<p>The stoichiometry matrix (<code>S</code>) is generated in <code><a href='spn_S.html'>spn_S</a></code>.</p>
<p>The list of hazards (<code>hazards</code>) come from <code><a href='spn_hazards.html'>spn_hazards</a></code>.</p>
<p>Several samplers are provided. The default is a Poisson Time-Step
(<code><a href='step_PTS.html'>step_PTS</a></code>) method. Other options are Gillespie's Direct Method
(<code><a href='step_DM.html'>step_DM</a></code>) and a Chemical Langevin sampler (<code><a href='step_CLE.html'>step_CLE</a></code>).
Additionally, for convenience, an ODE "sampler" (<code><a href='step_ODE.html'>step_ODE</a></code>) is
provided for compatibility with other samplers. This function uses methods from
<code>deSolve</code>.</p>
<p>If using the <code>ode</code> sampler, several <code>methods</code> are provided in the <code>deSolve</code>
package, see <code><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></code>. For inhomogeneous systems, consider
using the "rk4" method to avoid excessive integration times.</p>
<p>Additionally, <code>events</code> objects must follow the format required by
<code>deSolve</code>. This was done for consistency, see <code><a href='https://rdrr.io/pkg/deSolve/man/events.html'>events</a></code>
for more information.</p>
<p>This function tracks state variables by default; an optional argument <code>Sout</code>
can be provided to track number of event firings each time step (for discrete stochastic simulations),
or cumulative intensity (for continuous stochastic simulations), or the rate function of
particular events for ODE simulation. The matrix must have number of columns equal to
number of events in the system (the number of hazard functions), and a row for each tracking
variable. The function <code><a href='track_hinf.html'>track_hinf</a></code> is provided, which builds a matrix to track
human infection events.</p>
<p>To save output as .csv files, see <code><a href='sim_trajectory_CSV.html'>sim_trajectory_CSV</a></code>.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://www.slwu89.com'>Sean L. Wu</a>, <a href='https://github.com/GilChrist19'>Jared B. Bennett</a>, <a href='https://www.marshalllab.com'>John M. Marshall</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


