<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>MGDrivE: Inheritance Cube — MGDrivE-Cube • MGDrivE</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MGDrivE: Inheritance Cube — MGDrivE-Cube"><meta name="description" content="To model an arbitrary number of genotypes efficiently in the same mathematical
framework, we use a 3-dimensional array structure (cube) where each axis
represents the following information:
x: female adult mate genotype
y: male adult mate genotype
z: proportion of the offspring that inherits a given genotype (layer)

"><meta property="og:description" content="To model an arbitrary number of genotypes efficiently in the same mathematical
framework, we use a 3-dimensional array structure (cube) where each axis
represents the following information:
x: female adult mate genotype
y: male adult mate genotype
z: proportion of the offspring that inherits a given genotype (layer)

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MGDrivE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/mgdrive_examples.html">Example Simulations</a></li>
    <li><a class="dropdown-item" href="../articles/mgdrive_math.html">Mathematical Description</a></li>
    <li><a class="dropdown-item" href="../articles/mgdrive_run.html">Detailed Run Example</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/MarshallLab/MGDrivE" aria-label="View on GitHub"><span class="fa fa-lg fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MGDrivE: Inheritance Cube</h1>
      <small class="dont-index">Source: <a href="https://github.com/MarshallLab/MGDrivE/blob/HEAD/R/Cube-Auxiliary.R" class="external-link"><code>R/Cube-Auxiliary.R</code></a></small>
      <div class="d-none name"><code>MGDrivE-Cube.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>To model an arbitrary number of genotypes efficiently in the same mathematical
framework, we use a 3-dimensional array structure (cube) where each axis
represents the following information:</p><ul><li><p>x: female adult mate genotype</p></li>
<li><p>y: male adult mate genotype</p></li>
<li><p>z: proportion of the offspring that inherits a given genotype (layer)</p></li>
</ul></div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The cube structure gives us the flexibility to apply tensor operations to the
elements within our equations, so that we can calculate the stratified population
dynamics rapidly; and within a readable, flexible computational framework.
This becomes apparent when we define the equation we use for the computation
of eggs laid at any given point in time:</p>
<p>$$\overline{O(T_x)} = \sum_{j=1}^{n} \Bigg( \bigg( (\beta*\overline{s} * \overline{ \overline{Af_{[t-T_x]}}}) * \overline{\overline{\overline{Ih}}} \bigg) * \Lambda  \Bigg)^{\top}_{ij}$$</p>
<p>In this equation, the matrix containing the number of mated adult females
(\(\overline{\overline{Af}}\)) is multiplied element-wise with each one of
the layers containing the eggs genotypes proportions expected from this cross
(\(\overline{\overline{\overline{Ih}}}\)). The resulting matrix is then
multiplied by a binary 'viability mask' (\(\Lambda\)) that filters out
female-parent to offspring genetic combinations that are not viable due to
biological impediments (such as cytoplasmic incompatibility). The summation of
the transposed resulting matrix returns us the total fraction of eggs resulting
from all the male to female genotype crosses (\(\overline{O(T_x)}\)).</p>
<p>Note: For inheritance operations to be consistent within the framework the
summation of each element in the z-axis (this is, the proportions of each one
of the offspring's genotypes) must be equal to one.</p>
    </div>
    <div class="section level2">
    <h2 id="drive-specific-cubes">Drive-specific Cubes<a class="anchor" aria-label="anchor" href="#drive-specific-cubes"></a></h2>



<p>An inheritance cube in an array object that specifies inheritance probabilities
(offspring genotype probability) stratified by male and female parent genotypes.
MGDrivE provides the following cubes to model different gene drive systems:</p><ul><li><p><code><a href="cubeOneLocusTA.html">cubeOneLocusTA</a></code>: 1 Locus Maternal-Toxin/Zygotic-Antidote System</p></li>
<li><p><code><a href="cubeTwoLocusTA.html">cubeTwoLocusTA</a></code>: 2 Locus Maternal-Toxin/Zygotic-Antidote System</p></li>
<li><p><code><a href="cubeAlleleSail.html">cubeAlleleSail</a></code>: 3 Locus Allele Sail, similar to Oberhofer et. al.</p></li>
<li><p><code><a href="cubeASmidler.html">cubeASmidler</a></code>: Split drive design with significant parent-specific impacts</p></li>
<li><p><code><a href="cubeCLEAVRMF.html">cubeCLEAVRMF</a></code>: Cleave and Rescue</p></li>
<li><p><code><a href="cubeCLEAVRX.html">cubeCLEAVRX</a></code>: Cleave and Rescue, X-Linked</p></li>
<li><p><code><a href="cubeClvR.html">cubeClvR</a></code>: 1 Locus Cleave and Rescue (ClvR)</p></li>
<li><p><code><a href="cubeClvR2.html">cubeClvR2</a></code>: 2 Locus Cleave and Rescue (ClvR)</p></li>
<li><p><code><a href="cubeConfinableHoming.html">cubeConfinableHoming</a></code>: Confinable Homing</p></li>
<li><p><code><a href="cubeConfinableHomingX.html">cubeConfinableHomingX</a></code>: Confinable Homing, X-Linked</p></li>
<li><p><code><a href="cubeHoming1RA.html">cubeHoming1RA</a></code>: Homing Drive with 1 Resistance Allele</p></li>
<li><p><code><a href="cubeHomingDrive.html">cubeHomingDrive</a></code>: CRISPR (Clustered Regularly Interspaced Short Palindromic Repeats) with 2 Resistance Allele</p></li>
<li><p><code><a href="cubeHomingDriveSM.html">cubeHomingDriveSM</a></code>: CRISPR with Small-Molecule Induction</p></li>
<li><p><code><a href="cubeXHomingDeposition.html">cubeXHomingDeposition</a></code>: CRISPR, X-Linked</p></li>
<li><p><code><a href="cubeECHACR.html">cubeECHACR</a></code>: 2 Locus Eraser/Chaser Construct, Autosomal</p></li>
<li><p><code><a href="cubeECHACRX.html">cubeECHACRX</a></code>: 2 Locus Eraser/Chaser Construct, X-Linked</p></li>
<li><p><code><a href="cubeImmunizingReversalMF.html">cubeImmunizingReversalMF</a></code>: Immunizing Reversal/Basic Reversal</p></li>
<li><p><code><a href="cubeImmunizingReversalX.html">cubeImmunizingReversalX</a></code>: Immunizing Reversal</p></li>
<li><p><code><a href="cubeConfinableHomingJOHN.html">cubeConfinableHomingJOHN</a></code>: Original Cube Design (We DO NOT recommend using this)</p></li>
<li><p><code><a href="cubeKillerRescue.html">cubeKillerRescue</a></code>: Killer-Rescue System</p></li>
<li><p><code><a href="cubeMEDEA.html">cubeMEDEA</a></code>: MEDEA (Maternal Effect Dominant Embryonic Arrest)</p></li>
<li><p><code><a href="cubeReciprocalTranslocations.html">cubeReciprocalTranslocations</a></code>: Reciprocal Translocation</p></li>
<li><p><code><a href="cubeRIDL.html">cubeRIDL</a></code>: RIDL (Release of Insects with Dominant Lethality)</p></li>
<li><p><code><a href="cubeXShredderMF.html">cubeXShredderMF</a></code>: X-Shredder, Autosomal</p></li>
<li><p><code><a href="cubeXShredderY.html">cubeXShredderY</a></code>: X-Shredder, Y-Linked</p></li>
<li><p><code><a href="cubeMendelian.html">cubeMendelian</a></code>: Mendelian</p></li>
<li><p><code><a href="cubeSplitDrive.html">cubeSplitDrive</a></code>: Split CRISPR Drive</p></li>
<li><p><code><a href="cubeSplitDriveX.html">cubeSplitDriveX</a></code>: Split CRISTPR Drive, X-Linked</p></li>
<li><p><code><a href="cubeSplitDriveY.html">cubeSplitDriveY</a></code>: Split CRISTPR Drive, Y-Linked</p></li>
<li><p><code><a href="cubeTGD.html">cubeTGD</a></code>: trans-complementing Gene Drive</p></li>
<li><p><code><a href="cubeTGDX.html">cubeTGDX</a></code>: trans-complementing Gene Drive, X-Linked</p></li>
<li><p><code><a href="cubeWolbachia.html">cubeWolbachia</a></code>: Wolbachia</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="functions-for-cubes">Functions for Cubes<a class="anchor" aria-label="anchor" href="#functions-for-cubes"></a></h2>



<p>We provide one auxiliary function to operate on cube objects.</p><ul><li><p><code><a href="cube2csv.html">cube2csv</a></code>: Export slices of a cube to .csv format</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://chipdelmal.github.io" class="external-link">Héctor Manuel Sánchez Castellanos</a>, <a href="https://github.com/GilChrist19" class="external-link">Jared Bennett</a>, <a href="https://slwu89.github.io" class="external-link">Sean Wu</a>, <a href="https://www.marshalllab.com" class="external-link">John M. Marshall</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

