<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Zero-inflated Exponential Stochastic Matrix — calcHurdleExpKernel • MGDrivE</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Zero-inflated Exponential Stochastic Matrix — calcHurdleExpKernel"><meta name="description" content="Given a distance matrix from calcVinEll, calculate a
stochastic matrix where one step movement probabilities follow an zero-inflated
exponential density with a point mass at zero. The point mass at zero represents
the first stage of a two-stage process, where mosquitoes decide to stay at
their current node or leave anywhere. This parameter can be calculated from
lifetime probabilities to stay at the current node with the helper function
calcZeroInflation."><meta property="og:description" content="Given a distance matrix from calcVinEll, calculate a
stochastic matrix where one step movement probabilities follow an zero-inflated
exponential density with a point mass at zero. The point mass at zero represents
the first stage of a two-stage process, where mosquitoes decide to stay at
their current node or leave anywhere. This parameter can be calculated from
lifetime probabilities to stay at the current node with the helper function
calcZeroInflation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MGDrivE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/mgdrive_examples.html">Example Simulations</a></li>
    <li><a class="dropdown-item" href="../articles/mgdrive_math.html">Mathematical Description</a></li>
    <li><a class="dropdown-item" href="../articles/mgdrive_run.html">Detailed Run Example</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/MarshallLab/MGDrivE" aria-label="View on GitHub"><span class="fa fa-lg fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Zero-inflated Exponential Stochastic Matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/MarshallLab/MGDrivE/blob/HEAD/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>calcHurdleExpKernel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a distance matrix from <code><a href="calcVinEll.html">calcVinEll</a></code>, calculate a
stochastic matrix where one step movement probabilities follow an zero-inflated
exponential density with a point mass at zero. The point mass at zero represents
the first stage of a two-stage process, where mosquitoes decide to stay at
their current node or leave anywhere. This parameter can be calculated from
lifetime probabilities to stay at the current node with the helper function
<code><a href="calcZeroInflation.html">calcZeroInflation</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calcHurdleExpKernel</span><span class="op">(</span><span class="va">distMat</span>, <span class="va">rate</span>, <span class="va">p0</span>, eps <span class="op">=</span> <span class="fl">1e-20</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-distmat">distMat<a class="anchor" aria-label="anchor" href="#arg-distmat"></a></dt>
<dd><p>Distance matrix from <code><a href="calcVinEll.html">calcVinEll</a></code></p></dd>


<dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>Rate parameter of <code><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">Exponential</a></code> distribution</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>Point mass at zero</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Cutoff for extremely small probabilities, default is 1e-20</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If a mosquito leaves its current node, with probability \(1-p_{0}\), it
then chooses a destination node according to a standard exponential density
with rate parameter \(rate\).</p>
<p>The distribution and density functions for the zero inflated exponential kernel are given below:
$$
F(x)=p_{0}\theta(x) + (1-p_{0})(1-e^{-\lambda x})
$$
$$
f(x)=p_{0}\delta(x)+(1-p_{0})\lambda e^{-\lambda x}
$$
where \(\lambda\) is the rate parameter of the exponential distribution,
\(\theta(x)\) is the Heaviside step function and \(\delta(x)\) is the
Dirac delta function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># setup distance matrix</span></span></span>
<span class="r-in"><span><span class="co"># two-column matrix with latitude/longitude, in degrees</span></span></span>
<span class="r-in"><span><span class="va">latLong</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">180</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Vincenty Ellipsoid  distance formula</span></span></span>
<span class="r-in"><span><span class="va">distMat</span> <span class="op">=</span> <span class="fu"><a href="calcVinEll.html">calcVinEll</a></span><span class="op">(</span>latLongs <span class="op">=</span> <span class="va">latLong</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate hurdle exponential distribution over distances</span></span></span>
<span class="r-in"><span><span class="co">#  rate and point mass are just for example</span></span></span>
<span class="r-in"><span><span class="va">kernMat</span> <span class="op">=</span> <span class="fu">calcHurdleExpKernel</span><span class="op">(</span>distMat <span class="op">=</span> <span class="va">distMat</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1e6</span>, p0 <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://chipdelmal.github.io" class="external-link">Héctor Manuel Sánchez Castellanos</a>, <a href="https://github.com/GilChrist19" class="external-link">Jared Bennett</a>, <a href="https://slwu89.github.io" class="external-link">Sean Wu</a>, <a href="https://www.marshalllab.com" class="external-link">John M. Marshall</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

